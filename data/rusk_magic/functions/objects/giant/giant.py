#
# 実行ディレクトリを移動/datapacks/下まで移動
import sys
_dir = __file__.split('\\')
_i1 = _dir.index("datapacks")
_dir = "\\".join(_dir[:_i1+2])
sys.path.append(_dir+"\\")

from transformation import *

def main():

    # オブジェクト
    obj = mc_object("giant","rusk_magic:")
    # ボーン
    obj.add_bone("giant"      ,"root"      ,[   0, 192 ,0])
    obj.add_bone("bottom"     ,"giant"     ,[   0, 192 ,0])
    obj.add_bone("up"         ,"giant"     ,[   0, 192, 0])
    obj.add_bone("right_hip"  ,"bottom"    ,[  -9, 192, 0])
    obj.add_bone("right_leg"  ,"right_hip" ,[ -12, 180, 0])
    obj.add_bone("right_lap"  ,"right_leg" ,[ -12, 100, 0])
    obj.add_bone("right_foot" ,"right_lap" ,[ -12,  10, 0])
    obj.add_bone("left_hip"   ,"bottom"    ,[   9, 192, 0])
    obj.add_bone("left_leg"   ,"left_hip"  ,[  12, 180, 0])
    obj.add_bone("left_lap"   ,"left_leg"  ,[  12, 100, 0])
    obj.add_bone("left_foot"  ,"left_lap"  ,[  12,  10, 0])
    obj.add_bone("stomach"    ,"up"        ,[   0, 192, 0])
    obj.add_bone("chest"      ,"stomach"   ,[   0, 212, 0])
    obj.add_bone("head"       ,"chest"     ,[   0, 242, 5])
    obj.add_bone("right_arm"  ,"chest"     ,[ -22, 237, 0])
    obj.add_bone("right_wrist","right_arm" ,[ -82, 237, 0])
    obj.add_bone("left_arm"   ,"chest"     ,[  22, 237, 0])
    obj.add_bone("left_wrist" ,"left_arm"  ,[  82, 237, 0])
    # ディスプレイ
    obj.add_display("right_hip"  ,"right_hip"  ,"item",translation=[  -9, 181,-2],scale=[18,20,17])
    obj.add_display("right_leg"  ,"right_leg"  ,"item",translation=[ -12, 139, 0],scale=[10,80,10])
    obj.add_display("right_lap"  ,"right_lap"  ,"item",translation=[ -12,  55, 0],scale=[ 8,90, 8])
    obj.add_display("right_foot" ,"right_foot" ,"item",translation=[ -12,   5, 7],scale=[10,10,25])
    obj.add_display("left_hip"   ,"left_hip"   ,"item",translation=[   9, 181,-2],scale=[18,20,17])
    obj.add_display("left_leg"   ,"left_leg"   ,"item",translation=[  12, 139, 0],scale=[10,80,10])
    obj.add_display("left_lap"   ,"left_lap"   ,"item",translation=[  12,  55, 0],scale=[ 8,90, 8])
    obj.add_display("left_foot"  ,"left_foot"  ,"item",translation=[  12,   5, 7],scale=[10,10,25])
    obj.add_display("stomach"    ,"stomach"    ,"item",translation=[   0, 201,-2],scale=[30,20,15])
    obj.add_display("chest"      ,"chest"      ,"item",translation=[   0, 226, 0],scale=[45,30,20])
    obj.add_display("head"       ,"head"       ,"item",translation=[   0, 259, 5],scale=[40,40,40])
    obj.add_display("right_arm"  ,"right_arm"  ,"item",translation=[ -52, 236, 0],scale=[60, 8, 8])
    obj.add_display("right_wrist","right_wrist","item",translation=[-111, 236, 0],scale=[60, 7, 7])
    obj.add_display("left_arm"   ,"left_arm"   ,"item",translation=[  52, 236, 0],scale=[60, 8, 8])
    obj.add_display("left_wrist" ,"left_wrist" ,"item",translation=[ 111, 236, 0],scale=[60, 7, 7])
    
    # Output
    f = open(_dir+"/data/rusk_magic/functions/objects/giant/load.mcfunction","w")
    f.write("#> rusk_magic:objects/giant/load\n# Datas of giant's poses and animations.\n\ndata modify storage rusk_magic: objects.giant set value {}\n\n")

    ## idle
    _pose = pose(obj,"idle")
    _pose.rotate(  "right_hip",[1,0,0],-0.05)
    _pose.rotate(  "right_leg",[1,0,0],-0.05)
    _pose.rotate(  "right_lap",[1,0,0], 0.25)
    _pose.rotate( "right_foot",[1,0,0],-0.10)
    _pose.rotate(   "left_hip",[1,0,0],-0.05)
    _pose.rotate(   "left_leg",[1,0,0],-0.05)
    _pose.rotate(   "left_lap",[1,0,0], 0.25)
    _pose.rotate(  "left_foot",[1,0,0],-0.05)
    _pose.rotate(    "stomach",[1,0,0], 0.10)
    _pose.rotate(      "chest",[1,0,0], 0.12)
    _pose.rotate(       "head",[1,0,0], 0.15)
    _pose.rotate(  "right_arm",[0,0,1], 1.40)
    _pose.rotate(  "right_arm",[0,1,0], 0.20)
    _pose.rotate("right_wrist",[0,1,0], 0.10)
    _pose.rotate(   "left_arm",[0,0,1],-1.40)
    _pose.rotate(   "left_arm",[1,0,0],-0.20)
    _pose.rotate( "left_wrist",[0,1,0],-0.10)
    _pose.rotate( "left_wrist",[0,1,0],-0.10)
    # Write
    f.write(_pose.get_commands()+"\n\n")

    # 1 右足を出す
    _pose1:pose =  pose(obj,"right_to_forward")
    _pose1.rotate(  "right_hip",[1,0,0],-0.05)
    _pose1.rotate(  "right_leg",[1,0,0],-0.20)
    _pose1.rotate(  "right_leg",[0,0,1], 0.02,align="global")
    _pose1.rotate(  "right_lap",[1,0,0], 0.70)
    _pose1.rotate( "right_foot",[1,0,0], 0.17)
    _pose1.rotate(   "left_hip",[1,0,0], 0.03)
    _pose1.rotate(   "left_leg",[1,0,0],-0.00)
    _pose1.rotate(   "left_lap",[1,0,0], 0.10)
    _pose1.rotate(  "left_foot",[1,0,0], 0.00)
    _pose1.rotate(    "stomach",[1,0,0], 0.05)
    _pose1.rotate(    "stomach",[0,0,1],-0.05,align="global")
    _pose1.rotate(      "chest",[1,0,0], 0.10)
    _pose1.rotate(       "head",[1,0,0], 0.20)
    _pose1.rotate(  "right_arm",[0,0,1], 1.40)
    _pose1.rotate(  "right_arm",[1,0,0],-0.10)
    _pose1.rotate("right_wrist",[0,1,0], 0.20)
    _pose1.rotate(   "left_arm",[0,0,1],-1.50)
    _pose1.rotate(   "left_arm",[1,0,0],-0.10)
    _pose1.rotate( "left_wrist",[0,1,0],-0.20)
    # 2 右足前
    _pose2:pose =  pose(obj,"right_in_front")
    _pose2.rotate(  "right_hip",[1,0,0],-0.15)
    _pose2.rotate(  "right_leg",[1,0,0],-0.27)
    _pose2.rotate(  "right_leg",[0,0,1], 0.05,align="global")
    _pose2.rotate(  "right_lap",[1,0,0], 0.25)
    _pose2.rotate( "right_foot",[1,0,0], 0.17)
    _pose2.rotate(   "left_hip",[1,0,0], 0.10)
    _pose2.rotate(   "left_leg",[1,0,0], 0.22)
    _pose2.rotate(   "left_lap",[1,0,0], 0.35)
    _pose2.rotate(  "left_foot",[1,0,0],-0.20)
    _pose2.rotate(    "stomach",[1,0,0], 0.10)
    _pose2.rotate(    "stomach",[0,0,1], 0.07,align="global")
    _pose2.rotate(      "chest",[1,0,0], 0.15)
    _pose2.rotate(       "head",[1,0,0], 0.25)
    _pose2.rotate(  "right_arm",[0,0,1], 1.50)
    _pose2.rotate(  "right_arm",[1,0,0], 0.20)
    _pose2.rotate("right_wrist",[0,1,0], 0.20)
    _pose2.rotate(   "left_arm",[0,0,1],-1.40)
    _pose2.rotate(   "left_arm",[1,0,0],-0.50)
    _pose2.rotate( "left_wrist",[0,1,0],-0.20)
    _pose2.rotate( "left_wrist",[0,0,1],-0.10)
    _pose2.move( "giant",[0,-8,0])
    # 3 左足を出す
    _pose3:pose =  pose(obj,"right_to_forward")
    _pose3.rotate(  "right_hip",[1,0,0], 0.03)
    _pose3.rotate(  "right_leg",[1,0,0],-0.00)
    _pose3.rotate(  "right_lap",[1,0,0], 0.10)
    _pose3.rotate( "right_foot",[1,0,0], 0.00)
    _pose3.rotate(   "left_hip",[1,0,0],-0.05)
    _pose3.rotate(   "left_leg",[1,0,0],-0.20)
    _pose3.rotate(   "left_leg",[0,0,1],-0.02,align="global")
    _pose3.rotate(   "left_lap",[1,0,0], 0.70)
    _pose3.rotate(  "left_foot",[1,0,0], 0.17)
    _pose3.rotate(    "stomach",[1,0,0], 0.05)
    _pose3.rotate(    "stomach",[0,0,1], 0.05,align="global")
    _pose3.rotate(      "chest",[1,0,0], 0.10)
    _pose3.rotate(       "head",[1,0,0], 0.20)
    _pose3.rotate(   "right_arm",[0,0,1], 1.50)
    _pose3.rotate(   "right_arm",[1,0,0],-0.10)
    _pose3.rotate( "right_wrist",[0,1,0], 0.20)
    _pose3.rotate(  "left_arm",[0,0,1],-1.40)
    _pose3.rotate(  "left_arm",[1,0,0],-0.10)
    _pose3.rotate("left_wrist",[0,1,0],-0.20)
    # 4 左足前
    _pose4:pose =  pose(obj,"right_in_front")
    _pose4.rotate(  "right_hip",[1,0,0], 0.10)
    _pose4.rotate(  "right_leg",[1,0,0], 0.22)
    _pose4.rotate(  "right_lap",[1,0,0], 0.35)
    _pose4.rotate( "right_foot",[1,0,0],-0.20)
    _pose4.rotate(   "left_hip",[1,0,0],-0.15)
    _pose4.rotate(   "left_leg",[1,0,0],-0.27)
    _pose4.rotate(   "left_leg",[0,0,1],-0.05,align="global")
    _pose4.rotate(   "left_lap",[1,0,0], 0.25)
    _pose4.rotate(  "left_foot",[1,0,0], 0.17)
    _pose4.rotate(    "stomach",[1,0,0], 0.10)
    _pose4.rotate(    "stomach",[0,0,1],-0.07,align="global")
    _pose4.rotate(      "chest",[1,0,0], 0.15)
    _pose4.rotate(       "head",[1,0,0], 0.25)
    _pose4.rotate(   "right_arm",[0,0,1], 1.40)
    _pose4.rotate(   "right_arm",[1,0,0],-0.50)
    _pose4.rotate( "right_wrist",[0,1,0], 0.20)
    _pose4.rotate( "right_wrist",[0,0,1], 0.10)
    _pose4.rotate(  "left_arm",[0,0,1],-1.50)
    _pose4.rotate(  "left_arm",[1,0,0], 0.20)
    _pose4.rotate("left_wrist",[0,1,0],-0.20)
    _pose4.move( "giant",[0,-8,0])

    ## walk
    _anime = animation(obj,"walk", True, 200)
    # 1 右足を出す
    _frame:pose = _anime.add_keyframe(0)
    _anime.copy_pose(_frame,_pose1)
    # 2 右足前
    _frame:pose = _anime.add_keyframe(50)
    _anime.copy_pose(_frame,_pose2)
    # 3 左足を出す
    _frame:pose = _anime.add_keyframe(100)
    _anime.copy_pose(_frame,_pose3)
    # 4 左足前
    _frame:pose = _anime.add_keyframe(150)
    _anime.copy_pose(_frame,_pose4)
    # 滑らかに
    _frame:pose = _anime.insert_keyframe(40,0,50,"wave")
    _frame:pose = _anime.insert_keyframe(45,0,50,"wave")
    _frame:pose = _anime.insert_keyframe(55,50,100,"wave")
    _frame:pose = _anime.insert_keyframe(60,50,100,"wave")
    _frame:pose = _anime.insert_keyframe(140,100,150,"wave")
    _frame:pose = _anime.insert_keyframe(145,100,150,"wave")
    _frame:pose = _anime.insert_keyframe(155,150,0,"wave")
    _frame:pose = _anime.insert_keyframe(160,150,0,"wave")

    # Write
    f.write(_anime.get_commands()+"\n\n")

    f.close()


if __name__ == "__main__":
    main()